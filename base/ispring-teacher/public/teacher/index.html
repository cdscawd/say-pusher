<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Teacher Dev</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/>
<link rel="stylesheet" type="text/css" href="public/css/reset.css">
<link rel="stylesheet" type="text/css" href="public/css/index.css">
<body>
	
	<div id="container">
		<iframe id="frame" src="presentation/index.html"></iframe>
		<div class="controller-box">
			<div id="prev_step" class="prev_step">
				<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1514279778960" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4035" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M511.345 0C228.393 0 0 229.499 0 511.345 0 793.21 229.499 1022.71 511.345 1022.71c281.866 0 511.365-229.5 511.365-511.365C1022.71 229.499 794.317 0 511.345 0z m180.49 539.197L437.82 794.317c-7.782 7.803-17.817 11.14-27.852 11.14-10.036 0-20.05-3.337-27.853-11.14a39.014 39.014 0 0 1 0-55.706l227.266-227.266-226.14-223.908c-15.606-15.606-15.606-40.12 0-54.6 15.586-15.585 40.1-15.585 54.58 0l254.013 251.781c7.782 7.783 11.141 16.712 11.141 27.853 0 8.909-3.338 18.944-11.141 26.726z" p-id="4036" fill="#000000"></path></svg>
			</div>
			<div class="interact-box">
				<div class="praise">
					<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1514280810555" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1867" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M281.309268 427.670595C261.944518 439.988469 249.081083 460.574022 249.081083 478.737947 249.081083 478.737947 249.081083 480.465225 249.081083 485.647056L249.081083 504.972544 249.081083 504.972544 249.081083 968.784309 250.462397 968.784309 250.462397 968.784309C256.860161 1000.288175 284.722135 1023.999994 318.076245 1023.999994L899.653482 1023.999994C937.758459 1023.999994 968.648647 993.364619 968.648647 954.980386 968.648647 916.861911 937.729726 885.96078 899.653482 885.96078L685.069986 885.96078 941.456448 885.96078C987.043991 885.96078 1023.999997 848.786346 1023.999997 803.137251 1023.999997 757.395078 986.82815 720.313722 941.456448 720.313722L705.971467 720.313722 941.456448 720.313722C987.043991 720.313722 1023.999997 683.139288 1023.999997 637.490194 1023.999997 591.74802 986.82815 554.666665 941.456448 554.666665L681.831893 554.666665 893.1773 554.666665C934.858973 554.666665 968.648647 520.544602 968.648647 479.184893L968.648647 492.109219C968.648647 450.421788 934.694901 415.183825 893.059202 413.53117 893.059202 413.53117 767.960825 407.82824 634.260588 405.022308 646.953664 357.694543 671.572925 243.029382 650.378378 126.745097 622.702703-25.098032 456.64865 2.509805 456.64865 126.7451 442.810811 237.176473 456.64865 237.17647 428.972972 306.196077 407.321531 360.192016 328.844084 404.049761 295.705199 420.584608 291.13051 422.229869 286.772717 424.33818 282.688783 426.813832 281.441707 427.380077 280.774196 427.670595 280.774196 427.670595L281.309268 427.670595ZM60.235351 444.235292C26.968287 444.235292 3.0e-06 470.968908 3.0e-06 504.407733L3.0e-06 908.611865C3.0e-06 941.844189 26.937292 968.784309 60.235351 968.784309L193.729731 968.784309 193.729731 444.235292 60.235351 444.235292Z" p-id="1868"></path></svg>
				</div>
				<div class="like">
					<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1514280857295" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2538" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M724.992 58.026667c-84.309333 0-162.474667 42.325333-214.016 111.957333C459.434667 100.352 380.928 58.026667 296.96 58.026667 145.066667 58.026667 21.504 193.194667 21.504 359.082667c0 98.986667 44.373333 168.277333 79.872 224.256C204.8 745.472 464.554667 947.2 475.477333 955.733333c10.581333 8.192 22.869333 12.288 35.498667 12.288 12.288 0 24.917333-4.096 35.157333-12.288 10.922667-8.533333 271.018667-210.261333 374.101333-372.394667 35.498667-55.978667 79.872-125.269333 79.872-224.256C1000.106667 193.194667 876.544 58.026667 724.992 58.026667L724.992 58.026667 724.992 58.026667 724.992 58.026667zM724.992 58.026667" p-id="2539"></path></svg>
				</div>
			</div>
			<div id="next_step" class="next_step">
				<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1514279778960" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4035" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M511.345 0C228.393 0 0 229.499 0 511.345 0 793.21 229.499 1022.71 511.345 1022.71c281.866 0 511.365-229.5 511.365-511.365C1022.71 229.499 794.317 0 511.345 0z m180.49 539.197L437.82 794.317c-7.782 7.803-17.817 11.14-27.852 11.14-10.036 0-20.05-3.337-27.853-11.14a39.014 39.014 0 0 1 0-55.706l227.266-227.266-226.14-223.908c-15.606-15.606-15.606-40.12 0-54.6 15.586-15.585 40.1-15.585 54.58 0l254.013 251.781c7.782 7.783 11.141 16.712 11.141 27.853 0 8.909-3.338 18.944-11.141 26.726z" p-id="4036" fill="#000000"></path></svg>
			</div>
		</div>
		<div class="control">
			<div class="buttons">
				<button id="gotoFirstSlide">First Slide</button>
				<button id="prev">Prev Slide</button>
				<button id="next">Next Slide</button>		
				<button id="prev_step">Prev Step</button>
				<button id="next_step">Next Step</button>
			</div>
			<div id="end_time"></div>
			<div class="log">
				<p id="time"></p>
				<p id="slideIndex"></p>
			</div>	
		</div>
		<div id="logger"></div>
	</div>

<script src="https://js.pusher.com/4.1/pusher.min.js"></script>

<!-- Pusher js -->
<script>
	// var asd = function() {
	// 	playbackController.gotoNextSlide()
	// }

	// Pusher.logToConsole = true;
	// var pusher = new Pusher('aaef902e40a3359d109c', {
	// 	cluster: 'ap1',
	// 	encrypted: true
	// });
	// var channel = pusher.subscribe('my-channel');
	// channel.bind('my-event', function(data) {
	// 	console.log(data.message);
	// });
</script>

<!-- Ispring js -->
<script>
	var PLAY = "播放动画"
	var PAUSE = "暂停动画"
	var COUNT_DOWN = 1200000
	var playbackController
	var prevBtn = document.getElementById("prev")
	var nextBtn = document.getElementById("next")
	var playPrevStepBtn = document.getElementById("prev_step")
	var playNextStepBtn = document.getElementById("next_step")
	var gotoFirstSlide = document.getElementById("gotoFirstSlide")
	var timeLabel = document.getElementById("time")
	var slideIndexLabel = document.getElementById("slideIndex")
	var slidesCount
	var isPlayedPresentation

	// player init
	var ispringPresentationConnector = {}
	ispringPresentationConnector.register = function(player) {
		logger("Teacher Player Running...")
		var presentation = player.presentation()
		slidesCount = presentation.slides().count()
		playbackController = player.view().playbackController()
		initPlaybackControllerEventsHandlers()
		initButtonsEventsHandlers()
		sessionCountDown()
		player.view().playbackController().slideChangeEvent().addHandler(function(slideIndex) {
      logger("Page : " + slideIndex)
    })
		transitionEffectCompleteEvents()
	}
	
	// player event
	// Player-SDK/documentation/js-api/ispring.presenter.player.IPresentationPlaybackController.html#playbackState
	function initPlaybackControllerEventsHandlers() {
		playbackController.slideChangeEvent().addHandler(function(slideIndex) {
			slideIndexLabel.innerHTML = "Slide: " + (slideIndex + 1) + " / " + slidesCount
		})
		playbackController.clock().tickEvent().addHandler(function(clock) {
			var timeOffset = clock.timestamp().timeOffset()
			var minutes = Math.floor(timeOffset / 60)
			var seconds = Math.round(timeOffset % 60)
			timeLabel.innerHTML = (minutes < 10) ? "0" + minutes: minutes
			timeLabel.innerHTML += ":"
			timeLabel.innerHTML += (seconds < 10) ? "0" + seconds: seconds
		})
	}
	
	// control button
	// Player-SDK/documentation/js-api/ispring.presenter.player.IPresentationPlaybackController.html#gotoNextSlide
	function initButtonsEventsHandlers() {
		prevBtn.onclick = function() {
			playbackController.gotoPreviousSlide()
		}
		nextBtn.onclick = function() {
			playbackController.gotoNextSlide()
		}
		playPrevStepBtn.onclick = function() {
			playbackController.gotoPreviousStep()
		}
		playNextStepBtn.onclick = function() {
			// playbackController.play()
			playbackController.gotoNextStep()
		}
		gotoFirstSlide.onclick = function() {
			playbackController.gotoFirstSlide(false)
		}
	}

	// debug logger 
	function logger(text) {
    var logger = document.getElementById("logger")
    logger.innerHTML = logger.innerHTML + text + '<br>'
  }

	function transitionEffectCompleteEvents() {
		var slideTransitionController;
    slideTransitionController.transitionEffectStartEvent().addHandler(function(slideIndex){
        window.console.log("Transition to slide #" + slideIndex + " has been started.");
    });
	}

	// 倒计时 1200000
	function sessionCountDown() {
		var min, sec, LOCAL_COUNT_DOWN
		var timer = setInterval(function() {
			var neadGet = (typeof localStorage.getItem('LOCAL_COUNT_DOWN')) == 'object' ? true : false
      if (neadGet) {
				COUNT_DOWN = COUNT_DOWN - 1000
      } else {
        COUNT_DOWN = parseInt(localStorage.getItem('LOCAL_COUNT_DOWN'), 10)
				COUNT_DOWN = COUNT_DOWN - 1000
      }
			min = parseInt((COUNT_DOWN / 1000 / 60), 10)
			sec = parseInt((COUNT_DOWN - (min * 60 * 1000)) / 1000, 10)
			document.getElementById("end_time").innerHTML = "课程结束倒计时 " + min + "' " + sec + "''"
			LOCAL_COUNT_DOWN = (min * 60 * 1000) + (sec * 1000)
			window.localStorage.setItem('LOCAL_COUNT_DOWN', LOCAL_COUNT_DOWN)
			if (sec < 0) {
				document.getElementById("end_time").innerHTML = "你的课程已经结束"
				clearInterval(timer)
			}
		}, 1000)
	}
</script>
</body>
</html>